// {
// "status": "success",
// "result": {
// "type": "video",
// "author": {
// "avatar": "https://p16-sign-va.tiktokcdn.com/tos-maliva-avt-0068/a722dee32f65207d0516eb1bb3f3ae25~c5_300x300.jpeg?lk3s=45126217&nonce=60751&refresh_token=045dc00c8c2cba2161b9a09c0106d083&x-expires=1713546000&x-signature=EGRuOabw0Zyw88WVr2aBLSf6wnA%3D",
// "nickname": "sadarjiwa01"
// },
// "desc": "Terima kasih atas kerja kerasmu pak #jokowi #jokowidodo #fypシ゚viral #sadstory #sadvibes #foryoupage",
// "music": "https://sf16-ies-music-va.tiktokcdn.com/obj/musically-maliva-obj/7267457587866897157.mp3",
// "videoSD": "https://fastdl.muscdn.app/dl?url=aHR0cHM6Ly92MTZtLWRlZmF1bHQuYWthbWFpemVkLm5ldC8wZWI0N2FhMGI4NWIxNjcxYTAzMWYwNjE2ZWNmNTRjYS82NjIxYWFhZC92aWRlby90b3MvdXNlYXN0MmEvdG9zLXVzZWFzdDJhLXZlLTAwNjhjMDAzL29vQTlDN1VlV1hJSGZrRmtFS0dYNGVMb2FlTnJBQVNnQzhSY1JKLz9hPTAmYnRpPU9VQnpPVGc3UUdvNk9qWkFMM0FqTFRBellDTXhORE5nJmNoPTAmY3I9MCZkcj0wJmxyPWFsbCZjZD0wJTdDMCU3QzAlN0MwJmJyPTIwMzYmYnQ9MTAxOCZjcz0wJmRzPTYmZnQ9WEU1YkNxVDBtN2pQRDEyODl5cjczd1VXckl5S01lRn5PNSZtaW1lX3R5cGU9dmlkZW9fbXA0JnFzPTAmcmM9WldZOE0yWTFaenMyWnp0b05EczdQRUJwYW1sa08yNDVjbkYwY1RNek56Z3pNMEF3TmpaaE1UVTJYelF4TlRVdE1ERXVZU05lY0RGa01tUmpOR2xnTFMxa0x6WnpjdyUzRCUzRCZ2dnBsPTEmbD0yMDI0MDQxODE3MTkxNTI2NzQ4MEU1ODk5Q0NDM0RFODQzJmJ0YWc9ZTAwMDg4MDAw&name=c2FkYXJqaXdhMDE=&id=NzM3NTIwMjU2Ng==&type=mp4",
// "videoHD": "https://v16m-default.akamaized.net/0eb47aa0b85b1671a031f0616ecf54ca/6621aaad/video/tos/useast2a/tos-useast2a-ve-0068c003/ooA9C7UeWXIHfkFkEKGX4eLoaeNrAASgC8RcRJ/?a=0&bti=OUBzOTg7QGo6OjZAL3AjLTAzYCMxNDNg&ch=0&cr=0&dr=0&lr=all&cd=0%7C0%7C0%7C0&br=2036&bt=1018&cs=0&ds=6&ft=XE5bCqT0m7jPD1289yr73wUWrIyKMeF~O5&mime_type=video_mp4&qs=0&rc=ZWY8M2Y1Zzs2ZztoNDs7PEBpamlkO245cnF0cTMzNzgzM0AwNjZhMTU2XzQxNTUtMDEuYSNecDFkMmRjNGlgLS1kLzZzcw%3D%3D&vvpl=1&l=20240418171915267480E5899CCC3DE843&btag=e00088000",
// "video_hd": "https://dl.muscdn.app/c2FkYXJqaXdhMDE=/hd/aHR0cHM6Ly92MTZtLWRlZmF1bHQuYWthbWFpemVkLm5ldC9iODI3MTI0NmIzZjI2NTIxNDdmMDk1YWZiMmRiNTliZC82NjIxYWFhZC92aWRlby90b3MvdXNlYXN0MmEvdG9zLXVzZWFzdDJhLXYtMDA2OC9vSUFpb2QyZ0JFRDlWcjBIQXVpQWtnS3VQQWZpeUFnRWlHb2dCOS8/YT0wJmJ0aT1iR1J1Wkh4dk1YSXhjbTUzWm0xY1lGOWViV0Z6YUhGbU9nJTNEJTNEJmNoPTAmY3I9MCZkcj0wJmVyPTAmY2Q9MCU3QzAlN0MwJTdDMCZicj0yNDY4MCZidD0xMjM0MCZkcz00JmZ0PWFFS3BDcVQwbTdqUEQxMjg5eXI3M3dVV3JJeUtNZUZ+TzUmbWltZV90eXBlPXZpZGVvX21wNCZxcz0xMyZyYz1hbWxrTzI0NWNuRjBjVE16Tnpnek0wQnBhbWxrTzI0NWNuRjBjVE16Tnpnek0wQmVjREZrTW1Sak5HbGdMUzFrTHpaellTTmVjREZrTW1Sak5HbGdMUzFrTHpaemN3JTNEJTNEJnZ2cGw9MSZsPTIwMjQwNDE4MTcxOTE1OEM4REMzNDAxNDIzMDEzQ0VDREYmYnRhZz1lMDAwNDgwMDAmY2M9Mw==",
// "videoWatermark": "https://fastdl.muscdn.app/dl?url=aHR0cHM6Ly92MTZtLWRlZmF1bHQuYWthbWFpemVkLm5ldC9iZWRiNmU2MzUxNTYxYjgzMTMyYzVjNDZhZTcxMGE5ZS82NjIxYWFhZC92aWRlby90b3MvdXNlYXN0MmEvdG9zLXVzZWFzdDJhLXZlLTAwNjhjMDAyL29jNElBWHJRQ0tMUkZIWHFDTG83SkJJU1hHU2Zla0FlV2dFZXZrLz9hPTAmYnRpPU9VQnpPVGc3UUdvNk9qWkFMM0FqTFRBellDTXhORE5nJmNoPTAmY3I9MCZkcj0wJmxyPWFsbCZjZD0wJTdDMCU3QzAlN0MwJmJyPTI2MDQmYnQ9MTMwMiZjcz0wJmRzPTMmZnQ9WEU1YkNxVDBtN2pQRDEyODl5cjczd1VXckl5S01lRn5PNSZtaW1lX3R5cGU9dmlkZW9fbXA0JnFzPTAmcmM9YURvNU5UUmtOMlE2TkR4b04yazZQRUJwYW1sa08yNDVjbkYwY1RNek56Z3pNMEF5TmpVdU1HSXlYeTR4TkRFeFhtTmpZU05lY0RGa01tUmpOR2xnTFMxa0x6WnpjdyUzRCUzRCZ2dnBsPTEmbD0yMDI0MDQxODE3MTkxNTI2NzQ4MEU1ODk5Q0NDM0RFODQzJmJ0YWc9ZTAwMDg4MDAw&name=c2FkYXJqaXdhMDE=&id=NzM3NTIwMjU2Ng==&type=mp4"
// }
// }

// Path: src/pages/api/tiktok.ts

import { createSignal } from "solid-js";
import axios from "axios";

export default function InputScreen() {
  const [url, setUrl] = createSignal("");
  const [result, setResult] = createSignal<any>(null);
  const [error, setError] = createSignal("");
  const [loading, setLoading] = createSignal(false);

  const handleSubmit = async (e: Event) => {
    e.preventDefault();
    setLoading(true);
    setError("");
    setResult(null);

    try {
      const response = await axios.post("https://your-api.com/api/tiktok", { url: url() });
      setResult(response.data);
    } catch (err: any) {
      setError(err.message || "Failed to fetch data");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div class="p-4 max-w-md mx-auto">
      <form onSubmit={handleSubmit} class="space-y-4">
        <input
          type="text"
          placeholder="Paste TikTok URL"
          value={url()}
          onInput={(e) => setUrl(e.currentTarget.value)}
          class="w-full border p-2 rounded"
        />
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">
          {loading() ? "Loading..." : "Download"}
        </button>
      </form>

      {error() && <p class="text-red-500 mt-2">{error()}</p>}

      {result() && (
        <div class="mt-4 p-4 border rounded bg-gray-50">
          <h2 class="font-bold mb-2">Download Links:</h2>
           <video
              controls
              src={
                data()!.result.videoSD ??
                data()!.result.videoHD ??
                data()!.result.videoWatermark ??
                data()!.result.video_diyoun ??
                data()!.result.music ??
                ""
              }
              class=" rounded-md shadow-md my-3 w-3/4 mx-auto"
            ></video>
          <p><strong>Video:</strong> <a href={`https://dl.tiktokiocdn.workers.dev/api/download?url=${encodeURIComponent(data()!.result.videoHD ?? "")}&type=.mp4&title=${data()!.result.author?.nickname}`} class="text-blue-600 underline">Click to download</a></p>
          {result().thumbnail && (
            <img src={result().thumbnail} alt="Thumbnail" class="mt-2 w-48 rounded" />
          )}
        </div>
      )}
    </div>
  );
}

          
         
export default InputScreen;
